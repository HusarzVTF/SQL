


USE Stacja_Paliw;


GO


 IF OBJECT_ID('Ope.uspUdzWydt') IS NOT NULL
 DROP PROC Ope.uspUdzWydt;
 
 GO
 
 CREATE PROC Ope.uspUdzWydt
 
 AS
 
 BEGIN
 
 DECLARE @Wyda real=(SELECT SUM(Kwota) FROM [Stacja_Paliw].[Ope].[WynikOpe] WHERE Kategoria NOT IN('Przychody','Wynik'))

 SELECT  Kategoria,ROUND(Kwota/@Wyda,2) AS Udzial FROM [Stacja_Paliw].[Ope].[WynikOpe] WHERE Kategoria NOT IN('Przychody','Wynik')
 
 END
 
 --Procedura pokazujaca udzial poszczegolnych kategorii wydatkow w wydatkach ogolem--
 
 
 
 
 
