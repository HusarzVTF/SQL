
USE Stacja_Paliw

GO


IF OBJECT_ID('Ope.ufKsztWyplaty') IS NOT NULL
DROP FUNCTION Ope.ufKsztWyplaty;

GO

CREATE FUNCTION Ope.ufKsztWyplaty(@Okres_Pocz date, @Okres_Koniec date)



RETURNS money
WITH SCHEMABINDING  
AS

BEGIN

DECLARE @kosztWyplat money= (
SELECT ROUND(SUM(Do_Wyplaty),2) 
FROM Ope.Wyplaty 
WHERE Pierwszy_Dzien_Miesiaca >= @Okres_Pocz AND Ostatni_Dzien_Miesiaca <= @Okres_Koniec)

return @kosztWyplat

END

/* funkcja liczaca koszty plac za zamnkniete okresy rozliczeniowe (minimalny okres rozliczeniowy w tym wypadku to miesiac) */

